<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
  http://www.springframework.org/schema/util
  http://www.springframework.org/schema/util/spring-util-3.1.xsd">

    <util:constant id="dataDeliveryServerKey"
        static-field="com.raytheon.uf.common.datadelivery.request.DataDeliveryConstants.DATA_DELIVERY_SERVER" />
        
    <util:constant id="ebxmlRegistryServiceKey"
        static-field="com.raytheon.uf.common.registry.RegistryConstants.EBXML_REGISTRY_SERVICE" />
    
    <util:constant id="ebxmlLcmServiceKey"
        static-field="com.raytheon.uf.common.registry.RegistryConstants.EBXML_LCM_SERVICE" />

    <util:constant id="ebxmlQueryServiceKey"
        static-field="com.raytheon.uf.common.registry.RegistryConstants.EBXML_QUERY_SERVICE" />
   
	<!-- This bean references the dpa.properties prop file -->
	<bean id="soapRegistryManager"
		class="com.raytheon.uf.edex.registry.ebxml.services.soap.RemoteSOAPRegistryHandler">
		<constructor-arg ref="registryWebServiceClient" />
		<property name="host" value="${registry.host}" />
		<property name="port" value="${ebxml.registry.webserver.port}" />
		<property name="protocol" value="${ebxml.registry.protocol}" />
    </bean>
    
    <bean id="registryWebServiceClient"
		class="com.raytheon.uf.edex.registry.ebxml.services.soap.RegistrySOAPServices">
		<property name="securityInterceptor" ref="securityOutInterceptor" />
		<property name="serviceConfig" ref="RegistryServiceConfig" />
		<property name="securityConfig" ref="securityConfiguration" />
	</bean>
	
	<bean id="RegistryServiceConfig"
		class="com.raytheon.uf.common.registry.services.RegistryServiceConfiguration" />
		
	<bean id="securityOutInterceptor" class="org.apache.cxf.ws.security.wss4j.WSS4JOutInterceptor">
		<constructor-arg>
			<map>
				<entry key="mustUnderstand" value="false" />
				<entry key="enableNonceCache" value="false" />
				<entry key="enableTimestampCache" value="false" />
				<entry key="enableSamlOneTimeUseCache" value="false" />
				<entry key="action" value="Signature" />
				<entry key="user" value="${edex.security.keystore.alias}" />
				<entry key="signaturePropRefId" value="propRef"/>
				<entry key="propRef"  value-ref="encryptedPropertyLoader"/>
				<entry key="passwordCallbackClass"
					value="com.raytheon.uf.edex.registry.ebxml.acp.PasswordCallback" />
				<entry key="signatureParts"
					value="{Element}{http://schemas.xmlsoap.org/soap/envelope/}Body" />
				<entry key="signatureAlgorithm" value="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
			</map>
		</constructor-arg>
	</bean>
 
	<bean id="registryHandler"
		class="com.raytheon.uf.common.registry.ebxml.FactoryRegistryHandler">
		<property name="lcmFactory" ref="soapRegistryManager" />
		<property name="queryFactory" ref="soapRegistryManager" />
		<property name="encoderStrategy" ref="registryEncoder" />
	</bean>
	
	<bean id="registryEncoderType"
		class="com.raytheon.uf.common.registry.ebxml.encoder.RegistryEncoders$Type"
		factory-method="valueOf">
		<constructor-arg value="JAXB" />
	</bean>

	<bean id="registryEncoder"
		class="com.raytheon.uf.common.registry.ebxml.encoder.RegistryEncoders"
		factory-method="ofType" depends-on="ebxmlJaxbManager">
		<constructor-arg ref="registryEncoderType" />
	</bean>
	
	<bean id="ebxmlJaxbManager" factory-method="getInstance"
		class="com.raytheon.uf.common.registry.schemas.ebxml.util.EbxmlJaxbManager" />
	
</beans>